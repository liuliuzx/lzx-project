#include("/template/common/layout/_page_layout.html")
#@layout()

#define css()
<style>

</style>
#end

#define js()
<script type="text/javascript" src="#(RESOURCE_HOST)/static/ueditor/ueditor.config.js"></script>
<script type="text/javascript" src="#(RESOURCE_HOST)/static/ueditor/ueditor.all.min.js"></script>
#--<script type="text/javascript">

	//ue = UE.getEditor('vod_content');
	//var player_select='{volist name="player_list" id="vo"}{if condition="$vo.status eq '1'"}<option value="{$vo.from}">{$vo.show}</option>{/if}{/volist}';
	var downer_select=' #for(x:macVodDownList)#if(x.status.equals(com.lzx.movie.service.entity.status.MacVodDownStatus::USED))<option value="#(x.from)">#(x.show)</option>#end#end';
	//var server_select='{volist name="server_list" id="vo"}{if condition="$vo.status eq '1'"}<option value="{$vo.from}">{$vo.show}</option>{/if}{/volist}';
	
    layui.use(['form', 'upload', 'layer'], function () {
        // 操作对象
        var form = layui.form
            , layer = layui.layer
            , $ = layui.jquery;

        form.on('submit(sub)', function(data){

            util.sendAjax ({
                type: 'POST',
                url: '#(ctxPath)/movie/vod/vod/postAdd',
                data: $.param(data.field),
                loadFlag: true,
                success : function(data){
                    pop_close();
                }
            });

            return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
        });
        
        
        
        //添加下载组
        $('.j-downer-add').on('click',function(){
            downers_arr_len++;
            var tpl='<div class="layui-form-item" data-i="'+downers_arr_len+'"><label class="layui-form-label">下载'+(downers_arr_len)+'：</label><div class="layui-input-inline w200"><select name="vod_down_from[]"><option value="no">请选择下载器.</option>'+downer_select+'</select></div><div class="layui-input-inline w200"><input type="text" name="vod_down_note[]" class="layui-input" placeholder="备注信息"></div><div class="layui-input-inline w400">操作：&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-clear">清空</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-remove">删除</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-up">上移</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-down">下移</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-xz">校正</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-order">倒序</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-dn">去前缀</a>&nbsp;&nbsp;</div><div class="p10"></div><hr class="layui-bg-gray"><div class="layui-input-block"><textarea id="vod_content'+(downers_arr_len)+'" name="vod_down_url[]" class="layui-textarea" style="width:100%;height:150px"></textarea></div></div>';
            
            $("#downer_list").append(tpl);

            form.render('select');
        });
        
        
        
        
    });
</script>--#

<script type="text/javascript">
    ue = UE.getEditor('vod_content');
    //var player_select='{volist name="player_list" id="vo"}{if condition="$vo.status eq '1'"}<option value="{$vo.from}">{$vo.show}</option>{/if}{/volist}';
    var downer_select=' #for(x:macVodDownList)#if(x.status.equals(com.lzx.movie.service.entity.status.MacVodDownStatus::USED))<option value="#(x.from)">#(x.show)</option>#end#end';
    //var server_select='{volist name="server_list" id="vo"}{if condition="$vo.status eq '1'"}<option value="{$vo.from}">{$vo.show}</option>{/if}{/volist}';

    layui.use(['form','upload', 'layer'], function () {
        // 操作对象
        var form = layui.form
                , layer = layui.layer
                , $ = layui.jquery
                , upload = layui.upload;

        // 验证
        form.verify({
            vod_name: function (value) {
                if (value == "") {
                    return "请输入专题名称";
                }
            }
        });
        
        form.on('submit(sub)', function(data){
            util.sendAjax ({
                type: 'POST',
                url: '#(ctxPath)/movie/vod/vod/postAdd',
                data: $.param(data.field),
                loadFlag: true,
                success : function(data){
                    pop_close();
                }
            });

            return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
        });

        //点击小便签把值写入到输入框中--已实现
        $(document).on("click", ".extend", function(){
            $id = $(this).attr('data-id');
            if($id == 'vod_class' || $id == 'vod_keywords'){
                $val = $("input[id='"+$id+"']").val();
                if($val!=''){
                    $val = $val+',';
                }
                if($val.indexOf($(this).text())>-1){
                    return;
                }
                $("input[id='"+$id+"']").val($val+$(this).text());
            }else{
                $("input[id='"+$id+"']").val($(this).text());
            }
        });


      	//获取方便新增的小便签--已实现
        form.on('select(type_id)', function(data){
            $.post("/movie/vod/vod/getLittleTag", {id:data.value}, function(res) {
            	res=eval('(' + res + ')'); 
                if (res.code == 0) {
                    $.each(res.data, function(key, value){
                        $('.vod_'+key+"_label").html('');
                        if(value != ''){
                            $.each(value, function(key2, value2){
                                $(".vod_"+key+"_label").append('<a class="layui-btn layui-btn-xs extend" href="javascript:;" data-id="vod_'+key+'">'+value2+'</a>');
                            });
                        }
                    });
                }
            });
        });


        //图片上传功能--已实现
        upload.render({
            elem: '.layui-upload'
            ,url: "/movie/vod/file/upload?flag=vod"
            ,method: 'post'
            ,field:'upfile'
            ,before: function(input) {
                layer.msg('文件上传中...', {time:3000000});
            },done: function(res, index, upload) {
                var obj = this.item;
                if (res.code == 1) {
                    layer.msg(res.msg);
                    return false;
                }
                layer.closeAll();
                var input = $(obj).parent().parent().find('.upload-input');
                if ($(obj).attr('lay-type') == 'image') {
                    input.siblings('img').attr('src', res.data.url).show();
                }
                input.val(res.data.url);

                /* if(res.data.thumb_class !=''){
                    $('.'+ res.data.thumb_class).val(res.data.thumb[0].url);
                } */
            }
        });

        //缩略图显示，暂时未考虑完善--未实现
        $('.upload-input').hover(function (e){
            var e = window.event || e;
            var imgsrc = $(this).val();
            if(imgsrc.trim()==""){ return; }
            var left = e.clientX+document.body.scrollLeft+20;
            var top = e.clientY+document.body.scrollTop+20;
            $(".showpic").css({left:left,top:top,display:""});
            if(imgsrc.indexOf('://')<0){ imgsrc = ROOT_PATH  + '/' + imgsrc;	} else{ imgsrc = imgsrc.replace('mac:','http:'); }
            $(".showpic_img").attr("src", imgsrc);
        },function (e){
            $(".showpic").css("display","none");
        });


        //生成随机数--已实现
        function rndNum(under, over){
            switch(arguments.length){
                case 1: return parseInt(Math.random()*under+1);
                case 2: return parseInt(Math.random()*(over-under+1) + under);
                default: return 0;
            }
        }
        
        //随机生成其他信息--已实现
        $("#btn_rnd").click(function(){
            $("#vod_hits").val( rndNum(9999) );
            $("#vod_hits_month").val( rndNum(3000) );
            $("#vod_hits_week").val( rndNum(1000) );
            $("#vod_hits_day").val( rndNum(100) );
            $("#vod_up").val( rndNum(1000) );
            $("#vod_down").val( rndNum(1000) );
            $("#vod_score").val( rndNum(10) );
            $("#vod_score_all").val( rndNum(1000) );
            $("#vod_score_num").val( rndNum(100) );
        });

        //读取豆瓣影片信息--已实现
        var is_load=0;
        $('#btn_douban').click(function(){
            var id = $('#vod_douban_id').val();
            var that=$(this);

            if(id == '' || id < 10000){
                alert('请先填写该影片对应的豆瓣的ID');
                return;
            }
            if(is_load==1){
                return;
            }
            is_load=1;
            that.text('读取中...');
            $.ajax({
                type: 'post',
                dataType: "jsonp",
                jsonp: "callback",
                jsonpCallback:"douban",
                timeout: 5000,
                url: '//api.maccms.com/douban/?callback=douban&id=' + id,
                error: function(){
                    alert('请求解析服务器失败');
                },
                complete:function(){
                    is_load=0;
                    that.text('查询数据');
                },
                success:function(r){
                    if(r.code>1){
                        alert(r.msg);
                    }
                    else{
                        if(r.data.vod_total){
                            $('#vod_total').val(r.data.vod_total);
                        }
                        if(r.data.vod_serial){
                            $('#vod_continu').val(r.data.vod_serial);
                        }
                        if(r.data.vod_isend){
                            $('#vod_isend').val(r.data.vod_isend);
                        }
                        if(r.data.vod_name){
                            $('#vod_name').val(r.data.vod_name);
                        }
                        if(r.data.vod_sub){
                            $('#vod_sub').val(r.data.vod_sub);
                        }
                        if(r.data.vod_pic){
                            $('#vod_pic').val(r.data.vod_pic);
                        }
                        if(r.data.vod_year){
                            $('#vod_year').val(r.data.vod_year);
                        }
                        if(r.data.vod_lang){
                            $('#vod_lang').val(r.data.vod_lang);
                        }
                        if(r.data.vod_area){
                            $('#vod_area').val(r.data.vod_area);
                        }
                        if(r.data.vod_state){
                            $('#vod_state').val(r.data.vod_state);
                        }
                        if(r.data.vod_class){
                            $('#vod_type').val(r.data.vod_class);
                        }
                        if(r.data.vod_tag){
                            $('#vod_tag').val(r.data.vod_tag);
                        }
                        if(r.data.vod_actor){
                            $('#vod_actor').val(r.data.vod_actor);
                        }
                        if(r.data.vod_director){
                            $('#vod_director').val(r.data.vod_director);
                        }
                        if(r.data.vod_pubdate){
                            $('#vod_pubdate').val(r.data.vod_pubdate);
                        }
                        if(r.data.vod_writer){
                            $('#vod_writer').val(r.data.vod_writer);
                        }
                        if(r.data.vod_score){
                            $('#vod_score').val(r.data.vod_score);
                        }
                        if(r.data.vod_score_num){
                            $('#vod_score_num').val(r.data.vod_score_num);
                        }
                        if(r.data.vod_score_all){
                            $('#vod_score_all').val(r.data.vod_score_all);
                        }
                        if(r.data.vod_douban_score){
                            $('#vod_douban_score').val(r.data.vod_douban_score);
                        }
                        if(r.data.vod_duration){
                            $('#vod_duration').val(r.data.vod_duration);
                        }
                        if(r.data.vod_content){
                            //ue.setContent(r.data.vod_content);
                            $("#vod_blurb").val(r.data.vod_content);
                        }
                        $('#vod_reurl').val(r.data.vod_reurl);
                        $('#vod_author').val(r.data.vod_author);
                    }
                }
            });
        });


        $('.contents').on('click','.j-editor-clear',function(){
            $(this).parent().parent().find('textarea').val('');
        });
        $('.contents').on('click','.j-editor-remove',function(){
            var datai = $(this).parent().parent().attr('data-i');
            $(this).parent().parent().remove();
        });
        $('.contents').on('click','.j-editor-up',function(){
            var current = $(this).parent().parent();
            var current_index = current.index();
            var current_i = current.attr('data-i');
            var prev = current.prev();
            var prev_i = prev.attr('data-i');
            if(current_index>0){
                current.insertBefore(prev);
            }
        });
        $('.contents').on('click','.j-editor-down',function(){
            var current = $(this).parent().parent();
            var current_index = current.index();
            var current_i = current.attr('data-i');
            var next = current.next();
            var next_i = next.attr('data-i');

            if(next.length>0){
                current.insertAfter(next);
            }
        });

        $('.contents').on('click','.j-editor-xz',function(){
            var arr1,s1,s2,urlarr,urlarrcount;
            s1 = $(this).parent().parent().find('textarea').val(); s2="";
            if (s1.length==0){return false;}
            s1 = s1.replaceAll("\r","");
            arr1 = s1.split("\n");
            arr1len = arr1.length;
            for(j=0;j<arr1len;j++){
                if(arr1[j].length>0){
                    urlarr = arr1[j].split('$'); urlarrcount = urlarr.length-1;
                    if(urlarrcount==0){
                        arr1[j]= getPatName(j,arr1len,arr1[j]) + '$' + arr1[j];
                    }
                    s2+=arr1[j]+"\r\n";
                }
            }
            $(this).parent().parent().find('textarea').val(s2.trim()) ;
        });
        $('.contents').on('click','.j-editor-order',function(){
            var arr1,s1,s2,urlarr,urlarrcount;
            s1 = $(this).parent().parent().find('textarea').val(); s2="";
            if (s1.length==0){return false;}
            s1 = s1.replaceAll("\r","");
            arr1=s1.split("\n");
            for(j=arr1.length-1;j>=0;j--){
                if(arr1[j].length>0){
                    s2+=arr1[j]+"\r\n";
                }
            }
            $(this).parent().parent().find('textarea').val(s2.trim()) ;
        });
        $('.contents').on('click','.j-editor-dn',function(){
            var arr1,s1,s2,urlarr,urlarrcount;
            s1 = $(this).parent().parent().find('textarea').val(); s2="";
            if (s1.length==0){return false;}
            s1 = s1.replaceAll("\r","");
            arr1=s1.split("\n");
            for(j=0;j<arr1.length;j++){
                if(arr1[j].length>0){
                    urlarr = arr1[j].split('$'); urlarrcount = urlarr.length-1;
                    if(urlarrcount==0){
                        arr1[j] = arr1[j];
                    }
                    else{
                        arr1[j] = urlarr[1];
                    }
                    s2+=arr1[j]+"\r\n";
                }
            }
            $(this).parent().parent().find('textarea').val(s2.trim()) ;
        });

        //添加播放组--未实现
        $('.j-player-add').on('click',function(){
            players_arr_len++;
            var tpl='<div class="layui-form-item" data-i="'+players_arr_len+'"><label class="layui-form-label">播放'+(players_arr_len)+'：</label><div class="layui-input-inline w200"><select name="vod_play_from[]"><option value="no">请选择播放器.</option>'+player_select+'</select></div><div class="layui-input-inline w200"><select name="vod_play_server[]" ><option value="no">请选择服务器组.</option>'+server_select+'</select></div><div class="layui-input-inline w200"><input type="text" name="vod_play_note[]" class="layui-input" placeholder="备注信息" ></div><div class="layui-input-inline w400">操作：&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-clear">清空</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-remove">删除</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-up">上移</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-down">下移</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-xz">校正</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-order">倒序</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-dn">去前缀</a>&nbsp;&nbsp;</div><div class="p10"></div><div class="layui-input-block"><textarea id="vod_content'+(players_arr_len)+'" name="vod_play_url[]" class="layui-textarea " style="width:100%;height:150px"></textarea></div></div>';
            $("#player_list").append(tpl);

            form.render('select');
        });
        //添加下载组--已实现
        $('.j-downer-add').on('click',function(){
            var tpl='<div class="layui-form-item" data-i="'+downers_arr_len+'"><label class="layui-form-label">下载'+(downers_arr_len)+'：</label><div class="layui-input-inline w200"><select name="macVodRes['+downers_arr_len+'].from"><option value="no">请选择下载器.</option>'+downer_select+'</select></div><div class="layui-input-inline w200"><input type="text" name="macVodRes['+downers_arr_len+'].note" class="layui-input" placeholder="备注信息"></div><div class="layui-input-inline w400">操作：&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-clear">清空</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-remove">删除</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-up">上移</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-down">下移</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-xz">校正</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-order">倒序</a>&nbsp;&nbsp;<a href="javascript:void(0)" class="j-editor-dn">去前缀</a>&nbsp;&nbsp;</div><div class="p10"></div><hr class="layui-bg-gray"><div class="layui-input-block"><textarea id="vod_content'+(downers_arr_len)+'" name="macVodRes['+downers_arr_len+'].url" class="layui-textarea" style="width:100%;height:150px"></textarea></div></div>';
            $("#downer_list").append(tpl);
            form.render('select');
            downers_arr_len++;
            $("#downListSize").val(downers_arr_len);
        });

        /* if(players_arr_len==0 && downers_arr_len==0) {
            $('.j-player-add').click();
        } */
        if(downers_arr_len==0) {
            $('.j-downer-add').click();
        }
    });
    function FindNote(s){
        var res="";
        if (s.indexOf("DVD")>0){
            res="DVD";
        }
        else if (s.indexOf("TS")>0 || s.indexOf("TC")>0 || s.indexOf("抢先版")>0) {
            res="抢先版";
        }
        else if (s.indexOf("HD")>0){
            res="HD";
        }
        else if (s.indexOf("BD")>0){
            res="BD";
        }
        else if (s.indexOf("蓝光高清")>0){
            res="蓝光高清";
        }
        else if (s.indexOf("高清")>0){
            res="高清";
        }
        else if (s.indexOf("VCD")>0){
            res="VCD";
        }

        if (s.indexOf("国粤语")>0){
            res +="国粤语";
        }
        else if (s.indexOf("国语")>0){
            res +="国语";
        }
        else if (s.indexOf("粤语")>0){
            res +="粤语";
        }
        else if (s.indexOf("台语")>0){
            res +="台语";
        }
        else if (s.indexOf("英语")>0){
            res +="英语";
        }
        else if (s.indexOf("中文字幕")>0){
            res +="中文字幕";
        }
        return res;
    }

    function getPatName(n,l,s){
        var res="";
        var rc=false;
        if(s.indexOf("qvod:")>-1 || s.indexOf("bdhd:")>-1 || s.indexOf("cool:")>-1){
            var arr = s.split('|');
            if(arr.length>=2){
                res = arr[2].replace(/[^0-9]/ig,"");
                rc=true;

                if(res!=""){
                    if(res.length>3){
                        res += "期";
                    }
                    else if(l==1){
                        res = "全集";
                    }
                    else{
                        res = '第' + res + '集';
                    }

                }
                else{
                    res = FindNote(s);
                    if (s==""){
                        if (l==1){
                            res="全集";
                        }
                        else{
                            rc=false;
                        }
                    }
                }
            }
        }
        if(!rc){
            res = '第' + (n<9 ? '0' : '') + (n+1) + '集';
        }
        return res;
    }
    
</script>

#end

#define content()
<div class="x-body">
     <div class="showpic" style="display:none;"><img class="showpic_img" width="120" height="160"></div>
    
    <form class="layui-form layui-form-pane" method="post" action="">

        <div class="layui-tab">
            <ul class="layui-tab-title ">
                <li class="layui-this">基本信息</a></li>
                <li>其他信息</li>
                <?php if(!(empty($info['vod_id']) || (($info['vod_id'] instanceof \think\Collection || $info['vod_id'] instanceof \think\Paginator ) && $info['vod_id']->isEmpty()))): ?>
                <li>角色信息</li>
                <?php endif; ?>
            </ul>
            <div class="layui-tab-content">

                <div class="layui-tab-item layui-show">
                    
                <div class="layui-form-item">
                    <label class="layui-form-label">参数：</label>
                    <div class="layui-input-inline w150">
                            <select name="macVod.typeId" lay-filter="type_id">
                                <option value="">请选择分类</option>
                                #for(p:typeList)
                                	#if(p.type_mid==1)
                                		<option value="#(p.type_id)" #if(macVod.typeId?? && macVod.typeId==p.type_id)selected#end>#(p.type_name)</option>
                                		#for(c:p.child)
                                			<option value="#(c.type_id)" #if(macVod.typeId?? && macVod.typeId==c.type_id)selected#end>&nbsp;|&nbsp;&nbsp;&nbsp;|—#(c.type_name)</option>
                                		#end
                                	#end
                                #end	
                            </select>
                    </div>

                    <div class="layui-input-inline w150">
                            <select id='type' name="macVod.vodLevel" lay-verify="required">
			                    <option value="0">请选择推荐</option>
			                    #if(macVod.vodLevel ??)
			                    	#movieOption("VOD_LEVEL",macVod.vodLevel.toString())
			                    #else
			                     	#movieOption("VOD_LEVEL")
			                    #end
			                </select>
                    </div>
                    <div class="layui-input-inline w120">
                            <select name="macVod.vodStatus">
                             	#if(macVod.vodStatus ??)
			                    	#movieOption("VOD_STATUS",macVod.vodStatus.toString())
			                    #else
			                     	#movieOption("VOD_STATUS")
			                    #end
			                    	
                            </select>
                    </div>
                    <div class="layui-input-inline w120">
                        <select name="macVod.vodLock">
                            	#if(macVod.vodLock ??)
			                    	#movieOption("VOD_LOCK",macVod.vodLock.toString())
			                    #else
			                     	#movieOption("VOD_LOCK")
			                    #end
                        </select>
                    </div>
                    <div class="layui-input-inline w110">
                        <input type="checkbox" name="uptime" title="更新时间" value="1" checked class="layui-checkbox checkbox-ids" lay-skin="primary">
                    </div>
                </div>

                <div class="layui-form-item ">
                    <label class="layui-form-label">标题：</label>
                    <div class="layui-input-inline w500">
                        <input type="text" class="layui-input" value="#(macVod.vodName ??)" placeholder="请输入" name="macVod.vodName" id="vod_name">
                    </div>
                    <label class="layui-form-label">副标：</label>
                    <div class="layui-input-inline ">
                        <input type="text" class="layui-input" value="#(macVod.vodSub ??)" placeholder="" name="macVod.vodSub" id="vod_sub">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">别名：</label>
                    <div class="layui-input-inline w500">
                        <input type="text" class="layui-input" value="#(macVod.vodEn ??)" placeholder="" name="macVod.vodEn">
                    </div>
                    <label class="layui-form-label">首字母：</label>
                    <div class="layui-input-inline w70">
                        <input type="text" class="layui-input" value="#(macVod.vodLetter ??)" placeholder="" name="macVod.vodLetter">
                    </div>
                    <label class="layui-form-label">高亮：</label>
                    <div class="layui-input-inline w70">
                        <input type="text" class="layui-input color" value="#(macVod.vodColor ??)" placeholder="" name="macVod.vodColor">
                    </div>
                </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">TAG：</label>
                        <div class="layui-input-inline w500  ">
                            <input type="text" class="layui-input" value="#(macVod.vodTag ??)" placeholder=""  name="macVod.vodTag" id="vod_tag">
                        </div>


                        <label class="layui-form-label">总集数：</label>
                        <div class="layui-input-inline w70">
                            <input type="text" class="layui-input" value="#(macVod.vodTotal ??)" placeholder="" name="macVod.vodTotal" id="vod_total">
                        </div>
                        <label class="layui-form-label">连载数：</label>
                        <div class="layui-input-inline w70">
                            <input type="text" class="layui-input" value="#(macVod.vodSerial ??)" placeholder="" name="macVod.vodSerial" id="vod_serial">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">备注：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodRemarks ??)" placeholder="" name="macVod.vodRemarks" id="vod_remarks">
                        </div>
                        <label class="layui-form-label">上映日期：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodPubdate ??)" placeholder="" name="macVod.vodPubdate" id="vod_pubdate">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">主演：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodActor ??)" placeholder="" name="macVod.vodActor" id="vod_actor">
                        </div>
                        <label class="layui-form-label">导演：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodDirector ??)" placeholder="" name="macVod.vodDirector" id="vod_director">
                        </div>
                        <label class="layui-form-label">编剧：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodWriter ??)" placeholder="" name="macVod.vodWriter" id="vod_writer">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">电视频道：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodTv ??)" placeholder="" name="macVod.vodTv">
                        </div>
                        <label class="layui-form-label">节目周期：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodWeekday ??)" placeholder="" name="macVod.vodWeekday">
                        </div>
                        <label class="layui-form-label">视频时长：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodDuration ??)" placeholder="" name="macVod.vodDuration" id="vod_duration">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">豆瓣评分：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodDoubanScore ??)" placeholder="豆瓣网评分值" name="macVod.vodDoubanScore" id="vod_douban_score">
                        </div>
                        <label class="layui-form-label">豆瓣ID：</label>
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" value="#(macVod.vodDoubanId ??)" placeholder="" name="macVod.vodDoubanId" id="vod_douban_id">
                        </div>
                        <div class="layui-input-inline ">
                            <button type="button" class="layui-btn" id="btn_douban">查询数据</button>
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">关联视频：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodRelVod ??)" placeholder="如“变形金刚”1、2、3部ID分别为11,12,13或将每部都填“变形金刚”" name="macVod.vodRelVod">
                        </div>
                        <div class="layui-input-inline ">
                            <a class="layui-btn j-iframe" data-href="<?php echo url('vod/index'); ?>?select=1&input=vod_rel_vod" href="javascript:;" title="查询数据">查询数据</a>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">关联文章：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodRelArt ??)" placeholder="如“变形金刚资讯”1、2、3部ID分别为11,12,13或将每部都填“变形金刚资讯”" name="macVod.vodRelArt">
                        </div>
                        <div class="layui-input-inline ">
                            <a class="layui-btn j-iframe" data-href="<?php echo url('art/index'); ?>?select=1&input=vod_rel_art" href="javascript:;" title="查询数据">查询数据</a>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">扩展分类：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodClass ??)" placeholder="" id="vod_class" name="macVod.vodClass">
                        </div>
                        <div class=" vod_class_label">

                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">上映年代：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodYear ??)" placeholder="" id="vod_year" name="macVod.vodYear">
                        </div>
                        <div class=" vod_year_label">

                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">发行地区：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodArea ??)" placeholder="" id="vod_area" name="macVod.vodArea">
                        </div>
                        <div class=" vod_area_label">

                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">对白语言：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodLang ??)" placeholder="" id="vod_lang" name="macVod.vodLang">
                        </div>
                        <div class=" vod_lang_label">

                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">影片版本：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodVersion ??)" placeholder="" id="vod_version" name="macVod.vodVersion">
                        </div>
                        <div class=" vod_version_label">

                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">资源类别：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="#(macVod.vodState ??)" placeholder="" id="vod_state" name="macVod.vodState">
                        </div>
                        <div class=" vod_state_label">

                        </div>
                    </div>


                <div class="layui-form-item">
                    <label class="layui-form-label">图片：</label>
                    <div class="layui-input-inline w500 upload">
                        <input type="text" class="layui-input upload-input" style="max-width:100%;" value="#(macVod.vodPic ??)" placeholder="" id="vod_pic" name="macVod.vodPic">
                    </div>
                    <div class="layui-input-inline ">
                        <button type="button" class="layui-btn layui-upload" lay-data="{data:{thumb:1,thumb_class:'upload-thumb'}}" id="upload1">上传图片</button>
                    </div>
                </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">缩略图：</label>
                        <div class="layui-input-inline w500 upload">
                            <input type="text" class="layui-input upload-input upload-thumb" style="max-width:100%;" value="#(macVod.vodPicThumb ??)" placeholder="" id="vod_pic_thumb" name="macVod.vodPicThumb">
                        </div>
                        <div class="layui-input-inline ">
                            <button type="button" class="layui-btn layui-upload" lay-data="{data:{thumb:0,thumb_class:'upload-thumb'}}" id="upload2">上传图片</button>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">海报图：</label>
                        <div class="layui-input-inline w500 upload">
                            <input type="text" class="layui-input upload-input" style="max-width:100%;" value="#(macVod.vodPicSlide ??)" placeholder="" id="vod_pic_slide" name="macVod.vodPicSlide">
                        </div>
                        <div class="layui-input-inline ">
                            <button type="button" class="layui-btn layui-upload" lay-data="{data:{thumb:0,thumb_class:'upload-thumb'}}" id="upload3">上传图片</button>
                        </div>
                    </div>
                <div class="layui-form-item">
                        <label class="layui-form-label">简介：</label>
                    <div class="layui-input-block">
                        <textarea name="macVod.vodBlurb" id="vod_blurb" cols="" rows="3" class="layui-textarea"  placeholder="不填写将自动从第一页详情里获取前100个字" style="height:40px;">#(macVod.vodBlurb ??)</textarea>
                    </div>
                </div>


                    <script>
	                    var players_arr_len = #(vodPlayerList.size());
	            	 	var downers_arr_len =#(vodDownList.size());
                    </script>
					#--
                    <div id="player_list" class="contents">
                        #for(x : listAaa)
                        <div class="layui-form-item" data-i="{$key}">
                        <label class="layui-form-label">播放{$key}：</label>
                            <div class="layui-input-inline w200">
                            <select name="vod_play_from[]">
                            <option value="no">请选择播放器.</option>
                            {volist name="player_list" id="vo1"}{if condition="$vo1.status eq '1'"}
                            <option value="{$vo1.from}" {if condition="$vo1.from eq $vo.from"} selected {/if}>
                            {$vo1.show}</option>
                            {/if}
                            {/volist}</select>
                            </div>
                            <div class="layui-input-inline w200">
                            <select name="vod_play_server[]">
                            <option value="no">请选择服务器组.</option>
                            {volist name="server_list" id="vo2"}{if condition="$vo2.status eq '1'"}
                            <option value="{$vo2.from}" {if condition="$vo2.from eq $vo.server"} selected {/if}>{$vo2.show}</option>
                            {/if}{/volist}
                            </select>
                            </div>
                            <div class="layui-input-inline w200">
                            <input type="text" name="vod_play_note[]" class="layui-input" value="{$vo.note}" placeholder="备注信息"></div>
                            <div class="layui-input-inline w400">操作：
                            <a href="javascript:void(0)" class="j-editor-clear">清空</a>&nbsp;&nbsp;
                            <a href="javascript:void(0)" class="j-editor-remove">删除</a>&nbsp;&nbsp;
                            <a href="javascript:void(0)" class="j-editor-up">上移</a>&nbsp;&nbsp;
                            <a href="javascript:void(0)" class="j-editor-down">下移</a>&nbsp;&nbsp;
                            <a href="javascript:void(0)" class="j-editor-xz">校正</a>&nbsp;&nbsp;
                            <a href="javascript:void(0)" class="j-editor-order">倒序</a>&nbsp;&nbsp;
                            <a href="javascript:void(0)" class="j-editor-dn">去前缀</a>&nbsp;&nbsp;<br>
                            </div>
                            <div class="p10"> </div>
                            <div class="layui-input-block "><textarea id="vod_play_url{$key}" name="vod_play_url[]" type="text/plain" style="width:100%;height:150px">{$vo.url|mac_str_correct=###,'#',chr(13)}</textarea></div>
                        </div>
                        {/volist}
                    </div>
                    <div class="layui-form-item">
                        <label class=""><button class="layui-btn radius j-player-add" type="button">添加一组播放</button></label>
                        <div class="layui-input-block">

                        </div>
                    </div>--#

                    <hr class="layui-bg-gray">


                    <div id="downer_list" class="contents">
                        	<input name="downListSize" value="" id="downListSize"/>
                    </div>
                    <div class="layui-form-item">
                        <label class=""><button class="layui-btn radius j-downer-add" type="button">添加一组下载</button></label>
                        <div class="layui-input-block">

                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">详细介绍：</label>
                        <div class="layui-input-block">
                            <textarea id="vod_content" name="macVod.vodContent" type="text/plain" style="width:99%;height:150px">#(macVod.vodContent ??)</textarea>
                        </div>
                    </div>
        </div>

                <div class="layui-tab-item">
                        <div class="layui-form-item">
                            <label class="layui-form-label">顶数量：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodUp ??)" placeholder="" id="vod_up" name="macVod.vodUp">
                            </div>
                            <label class="layui-form-label">踩数量：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodDown ??)" placeholder="" id="vod_down" name="macVod.vodDown">
                            </div>
                            <button class="layui-btn" type="button" id="btn_rnd">随机生成</button>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">总人气：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodHits ??)" placeholder="" id="vod_hits" name="macVod.vodHits">
                            </div>
                            <label class="layui-form-label">月人气：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodHitsMonth ??)" placeholder="" id="vod_hits_month" name="macVod.vodHitsMonth" >
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">周人气：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodHitsWeek ??)" placeholder="" id="vod_hits_week" name="macVod.vodHitsWeek">
                            </div>
                            <label class="layui-form-label">日人气：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input " value="#(macVod.vodHitsDay ??)" placeholder="" id="vod_hits_day" name="macVod.vodHitsDay">
                            </div>
                        </div>


                        <div class="layui-form-item">
                            <label class="layui-form-label">平均分：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodScore ??)" placeholder="" id="vod_score" name="macVod.vodScore">
                            </div>
                            <label class="layui-form-label">总评分：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodScoreAll ??)" placeholder="" id="vod_score_all" name="macVod.vodScoreAll">
                            </div>
                            <label class="layui-form-label">总评次：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodScoreNum ??)" placeholder="" id="vod_score_num" name="macVod.vodScoreNum">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">点播积分：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodPointsPlay ??)" placeholder="" name="macVod.vodPointsPlay">
                            </div>
                            <label class="layui-form-label">下载积分：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodPointsDown ??)" placeholder="" name="macVod.vodPointsDown">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">编辑人：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodAuthor ??)" placeholder="" name="macVod.vodAuthor" id="vod_author">
                            </div>
                            <label class="layui-form-label">独立模板：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodTpl ??)" placeholder="" name="macVod.vodTpl">
                            </div>
                            <label class="layui-form-label">跳转URL：</label>
                            <div class="layui-input-inline ">
                                <input type="text" class="layui-input" value="#(macVod.vodJumpurl ??)" placeholder="" name="macVod.vodJumpurl" id="vod_jumpurl">
                            </div>
                        </div>
                    </div>

				#--
                <div class="layui-tab-item">
                    <div class="layui-form-item">
                        <label class="layui-form-label">采集网址：</label>
                        <div class="layui-input-inline w500">
                            <input type="text" class="layui-input" value="" placeholder="" id="role_cj" name="role_cj">
                        </div>
                        <button class="layui-btn" type="button" id="btn_role_cj">点击采集</button>
                    </div>

                    <?php if(!(empty($info['vod_id']) || (($info['vod_id'] instanceof \think\Collection || $info['vod_id'] instanceof \think\Paginator ) && $info['vod_id']->isEmpty()))): ?>
                    <iframe src="<?php echo url('role/index'); ?>?select=1&tab=vod&rid=<?php echo $info['vod_id']; ?>" marginwidth="0" marginheight="0" style="width:100%;height:600px;"></iframe>
                    <?php endif; ?>
                </div>
                --#
            </div>
        </div>
        
        <div class="layui-form-item">
            <label class="layui-form-label"></label>
            <button  class="layui-btn" lay-filter="sub" lay-submit>
                保存
            </button>
            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>

    </form>
</div>
#end